2026-02-18 08:13:45,531 [INFO] model_loader - 加载 Qwen2.5-VL 模型: Qwen/Qwen2.5-VL-3B-Instruct (torch.bfloat16)
2026-02-18 08:13:45,725 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:45,754 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:45,758 [WARNING] huggingface_hub.utils._http - Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
2026-02-18 08:13:45,775 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:45,808 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:45,842 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:45,849 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:45,888 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-18 08:13:45,930 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:45,959 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/chat_template.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:45,969 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/chat_template.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,002 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/chat_template.jinja "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,038 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/audio_tokenizer_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,067 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,100 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:46,108 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,149 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,187 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:46,196 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,238 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:46,247 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,284 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:46,291 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,330 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,370 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-18 08:13:46,806 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct "HTTP/1.1 200 OK"
2026-02-18 08:13:46,845 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,881 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/video_preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,909 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:46,917 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:46,949 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:46,983 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/video_preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:13:47,014 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:47,021 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:47,543 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:47,552 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:47,583 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/model.safetensors "HTTP/1.1 404 Not Found"
2026-02-18 08:13:47,617 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/model.safetensors.index.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:47,626 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/model.safetensors.index.json "HTTP/1.1 200 OK"
2026-02-18 08:13:47,668 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/revision/main "HTTP/1.1 200 OK"
2026-02-18 08:13:47,988 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/generation_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:13:47,996 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/generation_config.json "HTTP/1.1 200 OK"
2026-02-18 08:13:51,723 [INFO] model_loader - 模型显存占用: 7.1GB
2026-02-18 08:13:51,723 [INFO] simple_demo - ================================================================================
2026-02-18 08:13:51,723 [INFO] simple_demo - 模式: Custom | 图片: kpop.png
2026-02-18 08:13:51,723 [INFO] simple_demo - 目标: 'chicken dinner'
2026-02-18 08:13:51,763 [INFO] pgd_attack - [PGD] ========== QAA(量化感知) PGD攻击 ==========
2026-02-18 08:13:51,763 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-18 08:13:51,763 [INFO] pgd_attack - [PGD] 量化感知: True
2026-02-18 08:13:51,763 [INFO] pgd_attack - [PGD] 参数: eps=0.1255, alpha=0.0025, iters=500
2026-02-18 08:13:52,525 [INFO] pgd_attack - [PGD-Step0] Loss=10.6637, Pred='Theinese'
2026-02-18 08:13:52,525 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x000001DB1748EB00>
2026-02-18 08:13:52,791 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 34.1170
2026-02-18 08:13:52,791 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-18 08:13:52,983 [INFO] pgd_attack - [PGD-Step1] Loss=10.4159, Pred='Theoker'
2026-02-18 08:13:54,150 [INFO] pgd_attack - [PGD-Step5] Loss=8.6979, Pred='Theoker'
2026-02-18 08:13:55,386 [INFO] pgd_attack - [PGD-Step10] Loss=6.8292, Pred='Theoker'
2026-02-18 08:13:58,996 [INFO] pgd_attack - [PGD-Step25] Loss=5.4624, Pred='Theick,'
2026-02-18 08:14:04,400 [INFO] pgd_attack - [PGD-Step50] Loss=2.2229, Pred='Theicken dinner'
2026-02-18 08:14:15,329 [INFO] pgd_attack - [PGD-Step100] Loss=1.9386, Pred='Theicken dinner'
2026-02-18 08:14:37,437 [INFO] pgd_attack - [PGD-Step200] Loss=0.0032, Pred='chicken dinner'
2026-02-18 08:14:59,687 [INFO] pgd_attack - [PGD-Step300] Loss=0.0765, Pred='chicken dinner'
2026-02-18 08:15:21,987 [INFO] pgd_attack - [PGD-Step400] Loss=0.0000, Pred='chicken dinner'
2026-02-18 08:15:44,136 [INFO] pgd_attack - [PGD-Step499] Loss=0.0000, Pred='chicken dinner'
2026-02-18 08:15:44,241 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-18 08:15:44,241 [INFO] pgd_attack - [PGD] Loss: 10.6637 → 0.0000
2026-02-18 08:15:44,245 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.1255
2026-02-18 08:15:44,277 [INFO] model_loader - [保存] PNG: logs_and_outputs\20260218_081345\temp\temp_adv.png
2026-02-18 08:15:44,507 [INFO] model_loader - [验证-direct] 'chicken dinner'
2026-02-18 08:15:44,774 [INFO] model_loader - [验证-png] 'chicken dinner'
2026-02-18 08:15:44,774 [INFO] pgd_attack - [验证] 输出: 'chicken dinner'
2026-02-18 08:15:44,774 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-18 08:15:44,774 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-18 08:15:44,774 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-18 08:15:44,796 [INFO] simple_demo - [保存] 对抗图像 → logs_and_outputs\20260218_081345\adversarial\adv_Custom_kpop.png
