2026-02-18 08:01:23,724 [INFO] model_loader - 加载 Qwen2.5-VL 模型: Qwen/Qwen2.5-VL-3B-Instruct (torch.bfloat16)
2026-02-18 08:01:23,950 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:23,984 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:23,992 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,062 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,156 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,164 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,203 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,240 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,278 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/chat_template.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,285 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/chat_template.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,323 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/chat_template.jinja "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,359 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/audio_tokenizer_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,394 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,394 [WARNING] huggingface_hub.utils._http - Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
2026-02-18 08:01:24,428 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,437 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,482 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,519 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,529 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,563 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,570 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,605 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:24,611 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:24,657 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-18 08:01:24,690 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-18 08:01:25,099 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct "HTTP/1.1 200 OK"
2026-02-18 08:01:25,150 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:25,241 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/video_preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:25,277 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:25,286 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:25,329 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/processor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:25,365 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/video_preprocessor_config.json "HTTP/1.1 404 Not Found"
2026-02-18 08:01:25,399 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/preprocessor_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:25,411 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/preprocessor_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:25,934 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:25,938 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:25,978 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/model.safetensors "HTTP/1.1 404 Not Found"
2026-02-18 08:01:26,024 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/model.safetensors.index.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:26,036 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/model.safetensors.index.json "HTTP/1.1 200 OK"
2026-02-18 08:01:26,082 [INFO] httpx - HTTP Request: GET https://huggingface.co/api/models/Qwen/Qwen2.5-VL-3B-Instruct/revision/main "HTTP/1.1 200 OK"
2026-02-18 08:01:26,457 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct/resolve/main/generation_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-18 08:01:26,466 [INFO] httpx - HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/Qwen/Qwen2.5-VL-3B-Instruct/66285546d2b821cf421d4f5eb2576359d3770cd3/generation_config.json "HTTP/1.1 200 OK"
2026-02-18 08:01:30,104 [INFO] model_loader - 模型显存占用: 7.1GB
2026-02-18 08:01:30,104 [INFO] simple_demo - ================================================================================
2026-02-18 08:01:30,104 [INFO] simple_demo - 模式: Custom | 图片: kpop.png
2026-02-18 08:01:30,104 [INFO] simple_demo - 目标: 'chicken dinner'
2026-02-18 08:01:30,133 [INFO] pgd_attack - [PGD] ========== QAA(量化感知) PGD攻击 ==========
2026-02-18 08:01:30,133 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-18 08:01:30,133 [INFO] pgd_attack - [PGD] 量化感知: True
2026-02-18 08:01:30,133 [INFO] pgd_attack - [PGD] 参数: eps=0.1255, alpha=0.0025, iters=500
2026-02-18 08:01:30,796 [INFO] pgd_attack - [PGD-Step0] Loss=4.8338, Pred='oker'
2026-02-18 08:01:30,796 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x0000027AAF042F20>
2026-02-18 08:01:31,016 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 30.1581
2026-02-18 08:01:31,016 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-18 08:01:31,207 [INFO] pgd_attack - [PGD-Step1] Loss=4.7026, Pred='inese'
2026-02-18 08:01:32,064 [INFO] pgd_attack - [PGD-Step5] Loss=4.1474, Pred='inese'
2026-02-18 08:01:33,270 [INFO] pgd_attack - [PGD-Step10] Loss=1.9453, Pred='inese dinner'
2026-02-18 08:01:37,000 [INFO] pgd_attack - [PGD-Step25] Loss=1.5425, Pred='inese nug'
2026-02-18 08:01:42,316 [INFO] pgd_attack - [PGD-Step50] Loss=0.0604, Pred='icken dinner'
2026-02-18 08:01:52,919 [INFO] pgd_attack - [PGD-Step100] Loss=0.0065, Pred='icken dinner'
2026-02-18 08:02:17,191 [INFO] pgd_attack - [PGD-Step200] Loss=0.0003, Pred='icken dinner'
2026-02-18 08:02:41,311 [INFO] pgd_attack - [PGD-Step300] Loss=0.0000, Pred='icken dinner'
2026-02-18 08:03:04,427 [INFO] pgd_attack - [PGD-Step400] Loss=0.0000, Pred='icken dinner'
2026-02-18 08:03:28,069 [INFO] pgd_attack - [PGD-Step499] Loss=0.0000, Pred='icken dinner'
2026-02-18 08:03:28,169 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-18 08:03:28,169 [INFO] pgd_attack - [PGD] Loss: 4.8338 → 0.0000
2026-02-18 08:03:28,173 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.1255
2026-02-18 08:03:28,201 [INFO] model_loader - [保存] PNG: logs_and_outputs\20260218_080123\temp\temp_adv.png
2026-02-18 08:03:30,598 [INFO] model_loader - [验证-direct] 'The image shows four women sitting on a couch, each holding a bottle of Chicken Alfredo sauce. They appear to be celebrating or promoting the product. The background is filled with various text and logos related to the Chicken Alfredo sauce, suggesting it is an advertisement or promotional material.'
2026-02-18 08:03:33,118 [INFO] model_loader - [验证-png] 'The image shows four women sitting on a couch, each holding a bottle of Chicken Alfredo sauce. They appear to be celebrating or promoting the product. The background is filled with various text and logos related to the Chicken Alfredo sauce, suggesting it is an advertisement or promotional material.'
2026-02-18 08:03:33,118 [INFO] pgd_attack - [验证] 输出: 'The image shows four women sitting on a couch, each holding a bottle of Chicken Alfredo sauce. They appear to be celebrating or promoting the product. The background is filled with various text and logos related to the Chicken Alfredo sauce, suggesting it is an advertisement or promotional material.'
2026-02-18 08:03:33,118 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-18 08:03:33,118 [INFO] pgd_attack - [验证] 匹配: full=False, kw=1/2
2026-02-18 08:03:33,118 [INFO] pgd_attack - [验证] 判定: 失败
2026-02-18 08:03:33,159 [INFO] simple_demo - [保存] 对抗图像 → logs_and_outputs\20260218_080123\adversarial\adv_Custom_kpop.png
