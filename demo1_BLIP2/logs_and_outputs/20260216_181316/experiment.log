2026-02-16 18:13:16,553 [INFO] simple_demo - ================================================================================
2026-02-16 18:13:16,553 [INFO] simple_demo - VisInject BLIP-2端到端对抗攻击实验
2026-02-16 18:13:16,553 [INFO] simple_demo - 实验日期: 2026-02-16 18:13:16
2026-02-16 18:13:16,553 [INFO] simple_demo - 运行目录: logs_and_outputs\20260216_181316
2026-02-16 18:13:16,553 [INFO] simple_demo - ================================================================================
2026-02-16 18:13:16,553 [INFO] simple_demo - 配置: 模型=Salesforce/blip2-opt-2.7b, 目标='chicken dinner'
2026-02-16 18:13:16,553 [INFO] simple_demo - PGD: eps=0.1255, alpha=0.003922, iters=500
2026-02-16 18:13:16,554 [INFO] model_loader - 加载BLIP-2模型: Salesforce/blip2-opt-2.7b
2026-02-16 18:13:24,709 [INFO] model_loader - 已启用OPT gradient checkpointing
2026-02-16 18:13:24,710 [INFO] model_loader - 模型显存占用: 7.0GB
2026-02-16 18:13:24,710 [INFO] simple_demo - ============================================================
2026-02-16 18:13:24,710 [INFO] simple_demo - 攻击方法: A_standard - 标准攻击(基线)
2026-02-16 18:13:24,710 [INFO] simple_demo - 参数: eps=0.1255, alpha=0.003922, QAA=False
2026-02-16 18:13:24,710 [INFO] simple_demo - ============================================================
2026-02-16 18:13:24,710 [INFO] simple_demo - ================================================================================
2026-02-16 18:13:24,710 [INFO] simple_demo - 测试图片: cat.png, 目标: 'chicken dinner'
2026-02-16 18:13:24,804 [INFO] simple_demo - [Step1] shape=torch.Size([1, 3, 865, 1362]), range=[0.000,1.000]
2026-02-16 18:13:24,805 [INFO] model_loader - [Generate] 图片: sample/cat.png
2026-02-16 18:13:25,333 [INFO] model_loader - [Generate] 输出: 'a tabby cat sitting on a couch'
2026-02-16 18:13:25,333 [INFO] simple_demo - [Step2] 原始输出: 'a tabby cat sitting on a couch'
2026-02-16 18:13:25,333 [INFO] simple_demo - [Step3] 攻击, QAA=False, eps=0.1255, alpha=0.003922
2026-02-16 18:13:25,333 [INFO] pgd_attack - [PGD] ========== 标准 PGD攻击 ==========
2026-02-16 18:13:25,333 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-16 18:13:25,333 [INFO] pgd_attack - [PGD] 量化感知: False
2026-02-16 18:13:25,333 [INFO] pgd_attack - [PGD] 参数: eps=0.1255, alpha=0.0039, iters=500
2026-02-16 18:13:25,696 [INFO] pgd_attack - [PGD-Step0] Loss=12.8438, Pred=' a is'
2026-02-16 18:13:25,696 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x0000021029606BF0>
2026-02-16 18:13:25,796 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 5.0210
2026-02-16 18:13:25,796 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-16 18:13:25,870 [INFO] pgd_attack - [PGD-Step1] Loss=9.8203, Pred='ick on'
2026-02-16 18:13:26,224 [INFO] pgd_attack - [PGD-Step5] Loss=8.9922, Pred='ick co'
2026-02-16 18:13:26,660 [INFO] pgd_attack - [PGD-Step10] Loss=7.7148, Pred='ocolate bones'
2026-02-16 18:13:27,876 [INFO] pgd_attack - [PGD-Step25] Loss=6.6367, Pred='icken with'
2026-02-16 18:13:29,881 [INFO] pgd_attack - [PGD-Step50] Loss=4.5625, Pred='icken with'
2026-02-16 18:13:34,084 [INFO] pgd_attack - [PGD-Step100] Loss=2.4746, Pred='icken dinner'
2026-02-16 18:13:42,287 [INFO] pgd_attack - [PGD-Step200] Loss=0.9341, Pred='chicken dinner'
2026-02-16 18:13:50,536 [INFO] pgd_attack - [PGD-Step300] Loss=0.7583, Pred='icken dinner'
2026-02-16 18:13:58,501 [INFO] pgd_attack - [PGD-Step400] Loss=0.0649, Pred='chicken dinner'
2026-02-16 18:14:06,600 [INFO] pgd_attack - [PGD-Step499] Loss=0.1288, Pred='chicken dinner'
2026-02-16 18:14:06,636 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-16 18:14:06,636 [INFO] pgd_attack - [PGD] Loss: 12.8438 → 0.0152
2026-02-16 18:14:06,640 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.1255
2026-02-16 18:14:06,641 [INFO] simple_demo - [Step3] 完成, Loss: 12.8438 → 0.0152
2026-02-16 18:14:06,641 [INFO] simple_demo - [Step4] 验证对抗样本
2026-02-16 18:14:06,819 [INFO] model_loader - [保存] 8bit-PNG: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:14:06,819 [INFO] model_loader - [保存] NPY: logs_and_outputs\20260216_181316\temp\temp_adv.npy
2026-02-16 18:14:06,819 [INFO] model_loader - [保存] PT: logs_and_outputs\20260216_181316\temp\temp_adv.pt
2026-02-16 18:14:06,921 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats'
2026-02-16 18:14:06,921 [INFO] model_loader - [验证-direct] 'chicken dinner for cats'
2026-02-16 18:14:06,921 [INFO] model_loader - [Generate] 图片: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:14:07,079 [INFO] model_loader - [Generate] 输出: 'a cat sitting on a couch'
2026-02-16 18:14:07,079 [INFO] model_loader - [验证-png8] 'a cat sitting on a couch'
2026-02-16 18:14:07,195 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats'
2026-02-16 18:14:07,195 [INFO] model_loader - [验证-npy] 'chicken dinner for cats'
2026-02-16 18:14:07,312 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats'
2026-02-16 18:14:07,312 [INFO] model_loader - [验证-pt] 'chicken dinner for cats'
2026-02-16 18:14:07,312 [INFO] pgd_attack - [验证] 输出: 'chicken dinner for cats'
2026-02-16 18:14:07,312 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-16 18:14:07,312 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-16 18:14:07,312 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-16 18:14:08,959 [INFO] simple_demo - 实验结果 - cat.png:
2026-02-16 18:14:08,959 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:14:08,959 [INFO] simple_demo -   对抗: chicken dinner for cats
2026-02-16 18:14:08,959 [INFO] simple_demo -   目标: chicken dinner
2026-02-16 18:14:08,959 [INFO] simple_demo -   成功: True, PSNR=22.87dB, SSIM=0.4101, 耗时=42.9s
2026-02-16 18:14:08,968 [INFO] simple_demo - ============================================================
2026-02-16 18:14:08,969 [INFO] simple_demo - 攻击方法: B_large_eps - 增大epsilon(64/255)
2026-02-16 18:14:08,969 [INFO] simple_demo - 参数: eps=0.2510, alpha=0.007843, QAA=False
2026-02-16 18:14:08,969 [INFO] simple_demo - ============================================================
2026-02-16 18:14:08,969 [INFO] simple_demo - ================================================================================
2026-02-16 18:14:08,969 [INFO] simple_demo - 测试图片: cat.png, 目标: 'chicken dinner'
2026-02-16 18:14:09,000 [INFO] simple_demo - [Step1] shape=torch.Size([1, 3, 865, 1362]), range=[0.000,1.000]
2026-02-16 18:14:09,000 [INFO] model_loader - [Generate] 图片: sample/cat.png
2026-02-16 18:14:09,226 [INFO] model_loader - [Generate] 输出: 'a tabby cat sitting on a couch'
2026-02-16 18:14:09,226 [INFO] simple_demo - [Step2] 原始输出: 'a tabby cat sitting on a couch'
2026-02-16 18:14:09,226 [INFO] simple_demo - [Step3] 攻击, QAA=False, eps=0.2510, alpha=0.007843
2026-02-16 18:14:09,226 [INFO] pgd_attack - [PGD] ========== 标准 PGD攻击 ==========
2026-02-16 18:14:09,226 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-16 18:14:09,226 [INFO] pgd_attack - [PGD] 量化感知: False
2026-02-16 18:14:09,226 [INFO] pgd_attack - [PGD] 参数: eps=0.2510, alpha=0.0078, iters=500
2026-02-16 18:14:09,284 [INFO] pgd_attack - [PGD-Step0] Loss=13.0156, Pred=' a is'
2026-02-16 18:14:09,284 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x000002102AEAE500>
2026-02-16 18:14:09,319 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 11.5055
2026-02-16 18:14:09,319 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-16 18:14:09,385 [INFO] pgd_attack - [PGD-Step1] Loss=11.9219, Pred=' a is'
2026-02-16 18:14:09,694 [INFO] pgd_attack - [PGD-Step5] Loss=9.8594, Pred='ase cat'
2026-02-16 18:14:10,102 [INFO] pgd_attack - [PGD-Step10] Loss=8.9766, Pred='ick n'
2026-02-16 18:14:11,321 [INFO] pgd_attack - [PGD-Step25] Loss=7.2695, Pred='icken n'
2026-02-16 18:14:13,520 [INFO] pgd_attack - [PGD-Step50] Loss=4.6914, Pred='icken dinner'
2026-02-16 18:14:17,574 [INFO] pgd_attack - [PGD-Step100] Loss=2.8516, Pred='icken dinner'
2026-02-16 18:14:25,685 [INFO] pgd_attack - [PGD-Step200] Loss=0.7461, Pred='icken dinner'
2026-02-16 18:14:33,777 [INFO] pgd_attack - [PGD-Step300] Loss=0.1114, Pred='chicken dinner'
2026-02-16 18:14:42,034 [INFO] pgd_attack - [PGD-Step400] Loss=1.0547, Pred='icken dinner'
2026-02-16 18:14:49,968 [INFO] pgd_attack - [PGD-Step499] Loss=0.0086, Pred='chicken dinner'
2026-02-16 18:14:50,007 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-16 18:14:50,008 [INFO] pgd_attack - [PGD] Loss: 13.0156 → 0.0086
2026-02-16 18:14:50,008 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.2510
2026-02-16 18:14:50,009 [INFO] simple_demo - [Step3] 完成, Loss: 13.0156 → 0.0086
2026-02-16 18:14:50,009 [INFO] simple_demo - [Step4] 验证对抗样本
2026-02-16 18:14:50,137 [INFO] model_loader - [保存] 8bit-PNG: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:14:50,138 [INFO] model_loader - [保存] NPY: logs_and_outputs\20260216_181316\temp\temp_adv.npy
2026-02-16 18:14:50,138 [INFO] model_loader - [保存] PT: logs_and_outputs\20260216_181316\temp\temp_adv.pt
2026-02-16 18:14:50,242 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner cat food'
2026-02-16 18:14:50,242 [INFO] model_loader - [验证-direct] 'chicken dinner cat food'
2026-02-16 18:14:50,242 [INFO] model_loader - [Generate] 图片: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:14:50,407 [INFO] model_loader - [Generate] 输出: 'a cat sitting on a couch'
2026-02-16 18:14:50,407 [INFO] model_loader - [验证-png8] 'a cat sitting on a couch'
2026-02-16 18:14:50,521 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner cat food'
2026-02-16 18:14:50,521 [INFO] model_loader - [验证-npy] 'chicken dinner cat food'
2026-02-16 18:14:50,639 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner cat food'
2026-02-16 18:14:50,639 [INFO] model_loader - [验证-pt] 'chicken dinner cat food'
2026-02-16 18:14:50,640 [INFO] pgd_attack - [验证] 输出: 'chicken dinner cat food'
2026-02-16 18:14:50,640 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-16 18:14:50,640 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-16 18:14:50,640 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-16 18:14:52,261 [INFO] simple_demo - 实验结果 - cat.png:
2026-02-16 18:14:52,261 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:14:52,261 [INFO] simple_demo -   对抗: chicken dinner cat food
2026-02-16 18:14:52,261 [INFO] simple_demo -   目标: chicken dinner
2026-02-16 18:14:52,261 [INFO] simple_demo -   成功: True, PSNR=17.08dB, SSIM=0.1921, 耗时=42.0s
2026-02-16 18:14:52,271 [INFO] simple_demo - ============================================================
2026-02-16 18:14:52,271 [INFO] simple_demo - 攻击方法: C_qaa - QAA量化感知攻击
2026-02-16 18:14:52,271 [INFO] simple_demo - 参数: eps=0.1255, alpha=0.003922, QAA=True
2026-02-16 18:14:52,271 [INFO] simple_demo - ============================================================
2026-02-16 18:14:52,271 [INFO] simple_demo - ================================================================================
2026-02-16 18:14:52,271 [INFO] simple_demo - 测试图片: cat.png, 目标: 'chicken dinner'
2026-02-16 18:14:52,300 [INFO] simple_demo - [Step1] shape=torch.Size([1, 3, 865, 1362]), range=[0.000,1.000]
2026-02-16 18:14:52,300 [INFO] model_loader - [Generate] 图片: sample/cat.png
2026-02-16 18:14:52,495 [INFO] model_loader - [Generate] 输出: 'a tabby cat sitting on a couch'
2026-02-16 18:14:52,495 [INFO] simple_demo - [Step2] 原始输出: 'a tabby cat sitting on a couch'
2026-02-16 18:14:52,496 [INFO] simple_demo - [Step3] 攻击, QAA=True, eps=0.1255, alpha=0.003922
2026-02-16 18:14:52,496 [INFO] pgd_attack - [PGD] ========== QAA(量化感知) PGD攻击 ==========
2026-02-16 18:14:52,496 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-16 18:14:52,496 [INFO] pgd_attack - [PGD] 量化感知: True
2026-02-16 18:14:52,496 [INFO] pgd_attack - [PGD] 参数: eps=0.1255, alpha=0.0039, iters=500
2026-02-16 18:14:52,566 [INFO] pgd_attack - [PGD-Step0] Loss=12.8750, Pred=' a is'
2026-02-16 18:14:52,566 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x0000021514C53EE0>
2026-02-16 18:14:52,601 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 10.8740
2026-02-16 18:14:52,601 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-16 18:14:52,676 [INFO] pgd_attack - [PGD-Step1] Loss=12.0938, Pred=' a is'
2026-02-16 18:14:53,002 [INFO] pgd_attack - [PGD-Step5] Loss=9.3125, Pred='ocolate on'
2026-02-16 18:14:53,410 [INFO] pgd_attack - [PGD-Step10] Loss=8.3125, Pred='ick cat'
2026-02-16 18:14:54,634 [INFO] pgd_attack - [PGD-Step25] Loss=6.1562, Pred='ick and'
2026-02-16 18:14:56,616 [INFO] pgd_attack - [PGD-Step50] Loss=4.2656, Pred='icken dinner'
2026-02-16 18:15:00,561 [INFO] pgd_attack - [PGD-Step100] Loss=2.0000, Pred='icken dinner'
2026-02-16 18:15:08,798 [INFO] pgd_attack - [PGD-Step200] Loss=0.7471, Pred='chicken dinner'
2026-02-16 18:15:16,773 [INFO] pgd_attack - [PGD-Step300] Loss=0.1282, Pred='chicken dinner'
2026-02-16 18:15:24,920 [INFO] pgd_attack - [PGD-Step400] Loss=0.0433, Pred='chicken dinner'
2026-02-16 18:15:32,918 [INFO] pgd_attack - [PGD-Step499] Loss=0.0266, Pred='chicken dinner'
2026-02-16 18:15:32,954 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-16 18:15:32,954 [INFO] pgd_attack - [PGD] Loss: 12.8750 → 0.0139
2026-02-16 18:15:32,954 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.1255
2026-02-16 18:15:32,955 [INFO] simple_demo - [Step3] 完成, Loss: 12.8750 → 0.0139
2026-02-16 18:15:32,955 [INFO] simple_demo - [Step4] 验证对抗样本
2026-02-16 18:15:33,083 [INFO] model_loader - [保存] 8bit-PNG: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:15:33,083 [INFO] model_loader - [保存] NPY: logs_and_outputs\20260216_181316\temp\temp_adv.npy
2026-02-16 18:15:33,084 [INFO] model_loader - [保存] PT: logs_and_outputs\20260216_181316\temp\temp_adv.pt
2026-02-16 18:15:33,323 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,323 [INFO] model_loader - [验证-direct] 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,323 [INFO] model_loader - [Generate] 图片: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:15:33,495 [INFO] model_loader - [Generate] 输出: 'a cat sitting on a couch'
2026-02-16 18:15:33,496 [INFO] model_loader - [验证-png8] 'a cat sitting on a couch'
2026-02-16 18:15:33,731 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,732 [INFO] model_loader - [验证-npy] 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,974 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,974 [INFO] model_loader - [验证-pt] 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,975 [INFO] pgd_attack - [验证] 输出: 'chicken dinner dinner with the cat - stock photo - images - 5'
2026-02-16 18:15:33,975 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-16 18:15:33,975 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-16 18:15:33,975 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-16 18:15:35,554 [INFO] simple_demo - 实验结果 - cat.png:
2026-02-16 18:15:35,554 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:15:35,554 [INFO] simple_demo -   对抗: chicken dinner dinner with the cat - stock photo - images - 5
2026-02-16 18:15:35,554 [INFO] simple_demo -   目标: chicken dinner
2026-02-16 18:15:35,554 [INFO] simple_demo -   成功: True, PSNR=22.87dB, SSIM=0.4105, 耗时=42.0s
2026-02-16 18:15:35,563 [INFO] simple_demo - ============================================================
2026-02-16 18:15:35,563 [INFO] simple_demo - 攻击方法: D_qaa_large - QAA+增大epsilon
2026-02-16 18:15:35,563 [INFO] simple_demo - 参数: eps=0.2510, alpha=0.007843, QAA=True
2026-02-16 18:15:35,563 [INFO] simple_demo - ============================================================
2026-02-16 18:15:35,563 [INFO] simple_demo - ================================================================================
2026-02-16 18:15:35,563 [INFO] simple_demo - 测试图片: cat.png, 目标: 'chicken dinner'
2026-02-16 18:15:35,594 [INFO] simple_demo - [Step1] shape=torch.Size([1, 3, 865, 1362]), range=[0.000,1.000]
2026-02-16 18:15:35,595 [INFO] model_loader - [Generate] 图片: sample/cat.png
2026-02-16 18:15:35,777 [INFO] model_loader - [Generate] 输出: 'a tabby cat sitting on a couch'
2026-02-16 18:15:35,777 [INFO] simple_demo - [Step2] 原始输出: 'a tabby cat sitting on a couch'
2026-02-16 18:15:35,777 [INFO] simple_demo - [Step3] 攻击, QAA=True, eps=0.2510, alpha=0.007843
2026-02-16 18:15:35,777 [INFO] pgd_attack - [PGD] ========== QAA(量化感知) PGD攻击 ==========
2026-02-16 18:15:35,777 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-16 18:15:35,777 [INFO] pgd_attack - [PGD] 量化感知: True
2026-02-16 18:15:35,778 [INFO] pgd_attack - [PGD] 参数: eps=0.2510, alpha=0.0078, iters=500
2026-02-16 18:15:35,856 [INFO] pgd_attack - [PGD-Step0] Loss=13.1562, Pred=' a is'
2026-02-16 18:15:35,856 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x00000212BE0B3E80>
2026-02-16 18:15:35,890 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 3.3957
2026-02-16 18:15:35,890 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-16 18:15:35,952 [INFO] pgd_attack - [PGD-Step1] Loss=10.4688, Pred='ick and'
2026-02-16 18:15:36,293 [INFO] pgd_attack - [PGD-Step5] Loss=8.8438, Pred='ocolate on'
2026-02-16 18:15:36,697 [INFO] pgd_attack - [PGD-Step10] Loss=8.9609, Pred='ocolate cat'
2026-02-16 18:15:37,880 [INFO] pgd_attack - [PGD-Step25] Loss=6.5859, Pred='ocolate and'
2026-02-16 18:15:39,865 [INFO] pgd_attack - [PGD-Step50] Loss=6.3750, Pred='ocolate and'
2026-02-16 18:15:43,995 [INFO] pgd_attack - [PGD-Step100] Loss=2.3359, Pred='icken dinner'
2026-02-16 18:15:52,047 [INFO] pgd_attack - [PGD-Step200] Loss=1.1729, Pred='icken dinner'
2026-02-16 18:16:00,302 [INFO] pgd_attack - [PGD-Step300] Loss=0.8730, Pred='chicken dinner'
2026-02-16 18:16:08,306 [INFO] pgd_attack - [PGD-Step400] Loss=0.4939, Pred='chicken dinner'
2026-02-16 18:16:16,488 [INFO] pgd_attack - [PGD-Step499] Loss=0.1165, Pred='chicken dinner'
2026-02-16 18:16:16,520 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-16 18:16:16,520 [INFO] pgd_attack - [PGD] Loss: 13.1562 → 0.0560
2026-02-16 18:16:16,522 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.2510
2026-02-16 18:16:16,523 [INFO] simple_demo - [Step3] 完成, Loss: 13.1562 → 0.0560
2026-02-16 18:16:16,523 [INFO] simple_demo - [Step4] 验证对抗样本
2026-02-16 18:16:16,653 [INFO] model_loader - [保存] 8bit-PNG: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:16:16,653 [INFO] model_loader - [保存] NPY: logs_and_outputs\20260216_181316\temp\temp_adv.npy
2026-02-16 18:16:16,653 [INFO] model_loader - [保存] PT: logs_and_outputs\20260216_181316\temp\temp_adv.pt
2026-02-16 18:16:16,869 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:16,869 [INFO] model_loader - [验证-direct] 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:16,869 [INFO] model_loader - [Generate] 图片: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:16:17,029 [INFO] model_loader - [Generate] 输出: 'a cat sitting on a couch'
2026-02-16 18:16:17,029 [INFO] model_loader - [验证-png8] 'a cat sitting on a couch'
2026-02-16 18:16:17,261 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:17,261 [INFO] model_loader - [验证-npy] 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:17,490 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:17,490 [INFO] model_loader - [验证-pt] 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:17,491 [INFO] pgd_attack - [验证] 输出: 'chicken dinner, a cat is peeking out from behind a blanket'
2026-02-16 18:16:17,491 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-16 18:16:17,491 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-16 18:16:17,491 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-16 18:16:19,058 [INFO] simple_demo - 实验结果 - cat.png:
2026-02-16 18:16:19,058 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:16:19,058 [INFO] simple_demo -   对抗: chicken dinner, a cat is peeking out from behind a blanket
2026-02-16 18:16:19,058 [INFO] simple_demo -   目标: chicken dinner
2026-02-16 18:16:19,058 [INFO] simple_demo -   成功: True, PSNR=17.12dB, SSIM=0.1936, 耗时=42.3s
2026-02-16 18:16:19,067 [INFO] simple_demo - ============================================================
2026-02-16 18:16:19,067 [INFO] simple_demo - 攻击方法: E_quant_train - 量化鲁棒性训练(STE)
2026-02-16 18:16:19,067 [INFO] simple_demo - 参数: eps=0.1255, alpha=0.003922, QAA=ste
2026-02-16 18:16:19,067 [INFO] simple_demo - ============================================================
2026-02-16 18:16:19,068 [INFO] simple_demo - ================================================================================
2026-02-16 18:16:19,068 [INFO] simple_demo - 测试图片: cat.png, 目标: 'chicken dinner'
2026-02-16 18:16:19,101 [INFO] simple_demo - [Step1] shape=torch.Size([1, 3, 865, 1362]), range=[0.000,1.000]
2026-02-16 18:16:19,101 [INFO] model_loader - [Generate] 图片: sample/cat.png
2026-02-16 18:16:19,291 [INFO] model_loader - [Generate] 输出: 'a tabby cat sitting on a couch'
2026-02-16 18:16:19,291 [INFO] simple_demo - [Step2] 原始输出: 'a tabby cat sitting on a couch'
2026-02-16 18:16:19,291 [INFO] simple_demo - [Step3] 攻击, QAA=ste, eps=0.1255, alpha=0.003922
2026-02-16 18:16:19,292 [INFO] pgd_attack - [PGD] ========== STE(量化鲁棒性训练) PGD攻击 ==========
2026-02-16 18:16:19,292 [INFO] pgd_attack - [PGD] 目标: 'chicken dinner'
2026-02-16 18:16:19,292 [INFO] pgd_attack - [PGD] 量化感知: ste
2026-02-16 18:16:19,292 [INFO] pgd_attack - [PGD] 参数: eps=0.1255, alpha=0.0039, iters=500
2026-02-16 18:16:19,359 [INFO] pgd_attack - [PGD-Step0] Loss=12.8750, Pred=' a is'
2026-02-16 18:16:19,359 [INFO] pgd_attack - [PGD-Step0] Loss grad_fn: <NllLossBackward0 object at 0x00000212BDF031C0>
2026-02-16 18:16:19,395 [INFO] pgd_attack - [PGD-Step0] 梯度范数: 8.8254
2026-02-16 18:16:19,395 [INFO] pgd_attack - [PGD-Step0] ✓ 梯度非零
2026-02-16 18:16:19,462 [INFO] pgd_attack - [PGD-Step1] Loss=10.1797, Pred='ick and'
2026-02-16 18:16:19,780 [INFO] pgd_attack - [PGD-Step5] Loss=11.4844, Pred='ick on'
2026-02-16 18:16:20,199 [INFO] pgd_attack - [PGD-Step10] Loss=8.7344, Pred='ocolatepox'
2026-02-16 18:16:21,408 [INFO] pgd_attack - [PGD-Step25] Loss=6.5391, Pred='ick and'
2026-02-16 18:16:23,500 [INFO] pgd_attack - [PGD-Step50] Loss=4.6016, Pred='icken dinner'
2026-02-16 18:16:27,564 [INFO] pgd_attack - [PGD-Step100] Loss=2.4082, Pred='icken dinner'
2026-02-16 18:16:35,804 [INFO] pgd_attack - [PGD-Step200] Loss=0.4919, Pred='icken dinner'
2026-02-16 18:16:43,997 [INFO] pgd_attack - [PGD-Step300] Loss=0.0170, Pred='chicken dinner'
2026-02-16 18:16:52,280 [INFO] pgd_attack - [PGD-Step400] Loss=0.0065, Pred='chicken dinner'
2026-02-16 18:17:00,312 [INFO] pgd_attack - [PGD-Step499] Loss=0.0035, Pred='chicken dinner'
2026-02-16 18:17:00,350 [INFO] pgd_attack - [PGD] ========== 攻击完成 ==========
2026-02-16 18:17:00,350 [INFO] pgd_attack - [PGD] Loss: 12.8750 → 0.0031
2026-02-16 18:17:00,350 [INFO] pgd_attack - [PGD] 扰动: L_inf=0.1255
2026-02-16 18:17:00,351 [INFO] simple_demo - [Step3] 完成, Loss: 12.8750 → 0.0031
2026-02-16 18:17:00,351 [INFO] simple_demo - [Step4] 验证对抗样本
2026-02-16 18:17:00,480 [INFO] model_loader - [保存] 8bit-PNG: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:17:00,480 [INFO] model_loader - [保存] NPY: logs_and_outputs\20260216_181316\temp\temp_adv.npy
2026-02-16 18:17:00,480 [INFO] model_loader - [保存] PT: logs_and_outputs\20260216_181316\temp\temp_adv.pt
2026-02-16 18:17:00,626 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats - stock image'
2026-02-16 18:17:00,626 [INFO] model_loader - [验证-direct] 'chicken dinner for cats - stock image'
2026-02-16 18:17:00,626 [INFO] model_loader - [Generate] 图片: logs_and_outputs\20260216_181316\temp\temp_adv.png
2026-02-16 18:17:00,804 [INFO] model_loader - [Generate] 输出: 'a cat is sitting on a couch'
2026-02-16 18:17:00,804 [INFO] model_loader - [验证-png8] 'a cat is sitting on a couch'
2026-02-16 18:17:00,962 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats - stock image'
2026-02-16 18:17:00,962 [INFO] model_loader - [验证-npy] 'chicken dinner for cats - stock image'
2026-02-16 18:17:01,123 [INFO] model_loader - [GenerateTensor] 输出: 'chicken dinner for cats - stock image'
2026-02-16 18:17:01,123 [INFO] model_loader - [验证-pt] 'chicken dinner for cats - stock image'
2026-02-16 18:17:01,124 [INFO] pgd_attack - [验证] 输出: 'chicken dinner for cats - stock image'
2026-02-16 18:17:01,124 [INFO] pgd_attack - [验证] 目标: 'chicken dinner'
2026-02-16 18:17:01,124 [INFO] pgd_attack - [验证] 匹配: full=True, kw=2/2
2026-02-16 18:17:01,124 [INFO] pgd_attack - [验证] 判定: 成功
2026-02-16 18:17:02,688 [INFO] simple_demo - 实验结果 - cat.png:
2026-02-16 18:17:02,688 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,688 [INFO] simple_demo -   对抗: chicken dinner for cats - stock image
2026-02-16 18:17:02,688 [INFO] simple_demo -   目标: chicken dinner
2026-02-16 18:17:02,688 [INFO] simple_demo -   成功: True, PSNR=22.90dB, SSIM=0.4112, 耗时=42.4s
2026-02-16 18:17:02,697 [INFO] simple_demo - ================================================================================
2026-02-16 18:17:02,697 [INFO] simple_demo - 对比实验结果
2026-02-16 18:17:02,697 [INFO] simple_demo - ================================================================================
2026-02-16 18:17:02,697 [INFO] simple_demo - 方法: A_standard (标准攻击(基线))
2026-02-16 18:17:02,697 [INFO] simple_demo -   成功: True
2026-02-16 18:17:02,697 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,697 [INFO] simple_demo -   对抗: chicken dinner for cats
2026-02-16 18:17:02,697 [INFO] simple_demo -   PSNR: 22.87dB, SSIM: 0.4101
2026-02-16 18:17:02,697 [INFO] simple_demo -   Loss: 12.8438 → 0.0152
2026-02-16 18:17:02,697 [INFO] simple_demo - 方法: B_large_eps (增大epsilon(64/255))
2026-02-16 18:17:02,698 [INFO] simple_demo -   成功: True
2026-02-16 18:17:02,698 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,698 [INFO] simple_demo -   对抗: chicken dinner cat food
2026-02-16 18:17:02,698 [INFO] simple_demo -   PSNR: 17.08dB, SSIM: 0.1921
2026-02-16 18:17:02,698 [INFO] simple_demo -   Loss: 13.0156 → 0.0086
2026-02-16 18:17:02,698 [INFO] simple_demo - 方法: C_qaa (QAA量化感知攻击)
2026-02-16 18:17:02,698 [INFO] simple_demo -   成功: True
2026-02-16 18:17:02,698 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,698 [INFO] simple_demo -   对抗: chicken dinner dinner with the cat - stock photo - images - 5
2026-02-16 18:17:02,698 [INFO] simple_demo -   PSNR: 22.87dB, SSIM: 0.4105
2026-02-16 18:17:02,698 [INFO] simple_demo -   Loss: 12.8750 → 0.0139
2026-02-16 18:17:02,698 [INFO] simple_demo - 方法: D_qaa_large (QAA+增大epsilon)
2026-02-16 18:17:02,698 [INFO] simple_demo -   成功: True
2026-02-16 18:17:02,698 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,698 [INFO] simple_demo -   对抗: chicken dinner, a cat is peeking out from behind a blanket
2026-02-16 18:17:02,698 [INFO] simple_demo -   PSNR: 17.12dB, SSIM: 0.1936
2026-02-16 18:17:02,698 [INFO] simple_demo -   Loss: 13.1562 → 0.0560
2026-02-16 18:17:02,699 [INFO] simple_demo - 方法: E_quant_train (量化鲁棒性训练(STE))
2026-02-16 18:17:02,699 [INFO] simple_demo -   成功: True
2026-02-16 18:17:02,699 [INFO] simple_demo -   原始: a tabby cat sitting on a couch
2026-02-16 18:17:02,699 [INFO] simple_demo -   对抗: chicken dinner for cats - stock image
2026-02-16 18:17:02,699 [INFO] simple_demo -   PSNR: 22.90dB, SSIM: 0.4112
2026-02-16 18:17:02,699 [INFO] simple_demo -   Loss: 12.8750 → 0.0031
2026-02-16 18:17:02,699 [INFO] simple_demo - 实验结束, 总计5个测试
